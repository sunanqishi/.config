function sendTracking(a,b){!deferTracking&&ga&&ga("send","event",a,"clicked",b||"na")}var optOut=localStorage.getItem("tracking-opt-out"),deferTracking=!1;optOut&&"true"===optOut&&(deferTracking=!0),deferTracking||(!function(a,b,c,d,e,f,g){a.GoogleAnalyticsObject=e,a[e]=a[e]||function(){(a[e].q=a[e].q||[]).push(arguments)},a[e].l=1*new Date,f=b.createElement(c),g=b.getElementsByTagName(c)[0],f.async=1,f.src=d,g.parentNode.insertBefore(f,g)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-34217520-2","auto"),ga("set","checkProtocolTask",function(){}),ga("require","displayfeatures"),ga("send","pageview","/index.html")),function(){var a={tabsArray:[],currentTab:null,numRows:0,numCols:0,width:0,height:0,canvasHeight:100,canvasWidth:100,currentLayouts:null,defaultLayouts:{layoutItems:["1x1","1x2","2x1","2x2"]},layoutSprites:{layoutItems:["1x1","1x2","2x1","2x2","1x3","3x1","6x4-scale-horizontal","7x3-scale-horizontal","6x4-scale-vertical","7x3-scale-vertical"]},maxSelectorsPerLine:5,maxSelectorContainerWidth:156,maxSelectorContainerHeight:156,singleTab:!1,main_view:{},custom_view:{},options:{},util:{},badgeLimit:2,isMac:-1!==navigator.platform.toUpperCase().indexOf("MAC")};window.resize=a}(),function(){function a(a,b,c,e){$.isEmptyObject(a)?(d.width="horizontal"===e?Math.round(.1*window.screen.availWidth*b):window.screen.availWidth,d.height="horizontal"===e?window.screen.availHeight:Math.round(.1*window.screen.availHeight*b)):(d.width="horizontal"===e?Math.round(.1*a.width*b):a.width,d.height="horizontal"===e?a.height:Math.round(.1*a.height*b))}function b(a,b,c){$.isEmptyObject(a)?(d.width=Math.round(window.screen.availWidth/c),d.height=Math.round(window.screen.availHeight/b)):(d.width=Math.round(a.width/c),d.height=Math.round(a.height/b))}function c(a,b){$.isEmptyObject(a)?(d.offsetX=0,d.offsetY=0,d.fullWidth=window.screen.availWidth,d.fullHeight=window.screen.availHeight):(d.offsetX=a.left,d.offsetY=a.top,d.fullWidth=a.width,d.fullHeight=a.height),window.chrome.tabs.query({currentWindow:!0},function(a){d.tabsArray=a,window.chrome.tabs.query({currentWindow:!0,highlighted:!0},function(a){d.currentTab=a[0];var c=d.currentTab.index;a.length>1&&(d.tabsArray=a,c=0);var e=function(){return backJs.util.processTabs(d,d.tabsArray,c,d.currentTab.windowId,d.singleTab,d.currentTab.incognito,b)};d.singleTab?backJs.util.setUndoStorage(d,d.currentTab.index,d.currentTab.windowId,d.tabsArray.slice(c,c+1),e):backJs.util.setUndoStorage(d,d.currentTab.index,d.currentTab.windowId,d.tabsArray.slice(c),e)})})}var d=window.resize,e={initialize:function(){d.currentLayouts=JSON.parse(localStorage.getItem("layoutItems")),d.currentLayouts||(localStorage.setItem("layoutItems",JSON.stringify(d.defaultLayouts)),d.currentLayouts=$.extend(!0,{},d.defaultLayouts)),this.populateMainView();var a=localStorage.getItem("singleTab");a&&"true"===a&&($("#checkbox-single-tab").attr("checked",!0),$("label.single-tab").addClass("selected"),$("body").addClass("single-tab-selected"),d.singleTab=!0);var b=localStorage.getItem("emptyTab");b&&"true"!==b?$("body").addClass("empty-tab-not-selected"):($("#checkbox-empty-tab").attr("checked",!0),$("label.empty-tab").addClass("selected"),d.emptyTab=!0);var c=localStorage.getItem("displayLayer");c&&"true"!==c||($(".main-view").addClass("display-selected"),d.displayLayer=!0);var e=localStorage.getItem("alignment");e?(d.alignment=e,"left"!==d.alignment&&$("body").addClass("align-right")):d.alignment="left",$("#"+d.alignment).trigger("click",["defer-tracking"]),d.displayUtil.initialize(),localStorage.getItem("lastTab")&&$("#undo-layout").removeClass("disabled"),window.backJs=chrome.extension.getBackgroundPage(),chrome.runtime.onMessage.addListener(function(a){"enable-undo"===a&&d.options.enableUndoButton()});var f=Number(localStorage.getItem("updateBadge")),g=localStorage.getItem("version")||"",h="2.3.4">g&&""!==g;(!f||h)&&(f=0,localStorage.setItem("updateBadge",0),chrome.browserAction.setBadgeText({text:"NEW"}),chrome.browserAction.setBadgeBackgroundColor({color:[221,129,39,255]})),f<d.badgeLimit?(localStorage.setItem("updateBadge",++f),f===d.badgeLimit&&chrome.browserAction.setBadgeText({text:""})):chrome.browserAction.setBadgeText({text:""});var i=$("body");(!localStorage.getItem("update-seen")||h)&&(i.addClass("update"),h&&(localStorage.removeItem("update-seen"),localStorage.getItem("warning-seen")||(i.addClass("warning"),d.options.showWarningModal())),d.options.showUpdateModal()),$(function(){d.util.initSortable()})},populateMainView:function(){for(var a=0;a<d.currentLayouts.layoutItems.length;a++)d.layout.addLayoutMarkup(d.currentLayouts.layoutItems[a],!1)},initWindowWidth:function(){var a=d.currentLayouts.layoutItems.length;$("body").width(a<d.maxSelectorsPerLine?a*d.maxSelectorContainerWidth:d.maxSelectorsPerLine*d.maxSelectorContainerWidth)},checkWindowHeight:function(){var a=d.currentLayouts.layoutItems.length,b=a%d.maxSelectorsPerLine;a>=5&&0===b&&($("body").height($("body").height()-d.maxSelectorContainerHeight),$("html").height($("html").height()-d.maxSelectorContainerHeight))},resizeTabs:function(a,e){d.numRows=a,d.numCols=e;var f=$(".display-entry.selected").data();b(f,d.numRows,d.numCols),c(f)},resizeScaledTabs:function(b,e,f){d.numRows="horizontal"===f?1:2,d.numCols="horizontal"===f?2:1;var g=$(".display-entry.selected").data();a(g,b,e,f),c(g,f)}};window.resize.main_view=e}(),function(){function a(){return $("#horizontal-scaled").attr("checked")?"horizontal":"vertical"}function b(){return $(".scaled-input.selected").text().split(":")}var c=window.resize,d={hideCustomMenu:function(){$(".custom-view").addClass("hidden"),$(".main-view").removeClass("inactive"),c.util.clearCanvas()},showCustomMenu:function(){this.clearCustomValues(),$(".layout-option #fixed").trigger("click"),$(".main-view").addClass("inactive"),$(".custom-view").removeClass("hidden").trigger("show"),$(".custom-view input.row").focus()},clearCustomValues:function(){$("#numRows").val(""),$("#numCols").val(""),$("#input-save").addClass("disabled")},handleCustomSave:function(){var d,e=$(".custom-view").hasClass("scaled")?"scaled":"fixed";if("fixed"===e){var f=$("#numRows").val(),g=$("#numCols").val();this.clearCustomValues(),!Number(f)||!Number(g)||Number(f)<1||Number(g)<1||(d=f+"x"+g,c.layout.addLayout(d),c.layout.processTabInfo($(".layout-"+d)),this.hideCustomMenu())}else{var h=a(),i=b();d=i[0]+"x"+i[1]+"-scale-"+h,c.layout.addLayout(d),c.layout.processTabInfo($(".layout-"+d)),this.hideCustomMenu()}},showScaledMenu:function(){var d=a(),e=b(),f=document.getElementById("myCanvas"),g=f.getContext("2d");c.util.clearCanvas(),c.util.drawScaledTable(c.canvasWidth,c.canvasHeight,e[0],d,g)}};window.resize.custom_view=d}(),function(){var a=window.resize,b={processSingleTabSelection:function(b){var c=b?!0:!1;localStorage.setItem("singleTab",c),a.singleTab=c,$("label.single-tab").toggleClass("selected"),$("body").toggleClass("single-tab-selected")},processEmptyTabSelection:function(b){var c=b?!0:!1;localStorage.setItem("emptyTab",c),a.emptyTab=c,$("label.empty-tab").toggleClass("selected"),$("body").toggleClass("empty-tab-not-selected")},processDisplayLayerSelection:function(b){var c=b?!0:!1;localStorage.setItem("displayLayer",c),a.displayLayer=c},processAlignmentSelection:function(b){localStorage.setItem("alignment",b),a.alignment=b,"right"===b?$("body").addClass("align-right"):$("body").removeClass("align-right")},disableUndoButton:function(){a.lastTab=null,localStorage.removeItem("lastTab"),$("#undo-layout").addClass("disabled")},enableUndoButton:function(){$("#undo-layout").removeClass("disabled")},hideConfirmationModal:function(){$(".main-view").removeClass("inactive"),$(".confirmation-modal").addClass("hidden")},showConfirmationModal:function(){$(".confirmation-modal").removeClass("hidden").trigger("show"),$(".main-view").addClass("inactive")},hideUpdateModal:function(){$("body").removeClass("update"),$(".main-view").removeClass("inactive"),localStorage.setItem("update-seen",!0),localStorage.setItem("version","2.3.4")},showUpdateModal:function(){$("#update-modal").trigger("show"),$(".main-view").addClass("inactive")},hidePromoModal:function(){$("body").removeClass("promo"),$(".main-view").removeClass("inactive"),localStorage.setItem("promo-seen",!0)},showPromoModal:function(){$("#promo-modal").trigger("show"),$(".main-view").addClass("inactive")},hideWarningModal:function(){$("body").removeClass("warning"),localStorage.setItem("warning-seen",!0)},showWarningModal:function(){$("#warning-modal").trigger("show"),$(".main-view").addClass("inactive")}};window.resize.options=b}(),function(){function a(a,b,c){for(var d=1;b<c.length&&5>d;b++,d++){a=c[b];var e=$(".resize-container").find(".tab-layer-"+d);e.addClass("valid-tab");for(var f=0;f<e.length;f++)a.favIconUrl&&0!==a.favIconUrl.indexOf("chrome://")&&e.eq(f).find(".fav-icon").css("background-image",'url("'+a.favIconUrl+'")'),e.eq(f).attr("title",a.title)}}var b=window.resize,c={updateLayoutStore:function(){for(var a=$(".resize-selector"),c=a.length,d=0,e=[];c>d;d++)e.push(a.eq(d).attr("data-selector-type"));b.currentLayouts.layoutItems=e,localStorage.setItem("layoutItems",JSON.stringify(b.currentLayouts))},addLayout:function(a){var c=b.currentLayouts.layoutItems,d=c.indexOf(a);-1!==d&&(c.splice(d,1),this._removeLayoutMarkup(a)),b.currentLayouts.layoutItems.unshift(a),localStorage.setItem("layoutItems",JSON.stringify(b.currentLayouts)),this.addLayoutMarkup(a,!0),b.util.resetSortable()},addLayoutMarkup:function(a,c){var d="layout-default",e="";(-1!==b.layoutSprites.layoutItems.indexOf(a)||"1x1"===a)&&(d="layout-"+a),-1!==a.indexOf("scale")&&(e=a.split("-")[0].split("x").join(":"));var f=$(".resize-container"),g='<li class="resize-selector-container"><div class="close-button"></div><div class="layout-title">'+(e||a)+'</div><div class="resize-selector '+d+'" data-selector-type="'+a+'"></div></li>';c?f.prepend(g):f.append(g)},removeLayout:function(a){var c=b.currentLayouts.layoutItems,d=c.indexOf(a);c.splice(d,1),localStorage.setItem("layoutItems",JSON.stringify(b.currentLayouts)),this._removeLayoutMarkup(a)},_removeLayoutMarkup:function(a){var b='[data-selector-type="'+a+'"]';$(b).parent().remove()},resetLayout:function(){this._removeAllLayouts(),localStorage.setItem("layoutItems",JSON.stringify(b.defaultLayouts)),b.currentLayouts=$.extend(!0,{},b.defaultLayouts),b.main_view.populateMainView(),this.processTabInfo(),b.util.resetSortable()},_removeAllLayouts:function(){$(".resize-container").children().remove()},processTabInfo:function(c){var d,e,f,g,h,i,j,k=b.currentWindowTabs,l=c||$(".resize-container").find(".resize-selector-container .resize-selector"),m=0,n=0;if(l=l.filter(function(){return!$(this).hasClass("layout-default")}),m=l.length,k&&k.length>0){for(;m>n;n++){if(h="",d=l.eq(n),-1===d.attr("data-selector-type").indexOf("scale")){e=d.attr("data-selector-type").split("x"),f=e[0],g=e[1],j=1;for(var o=0;f>o;o++)for(var p=0;g>p;p++)h+='<div title="New Tab" class="tab-layer tab-layer-'+j++ +'"><div class="fav-icon"></div></div>'}else h+='<div title="New Tab" class="tab-layer tab-layer-1"><div class="fav-icon"></div></div><div title="New Tab" class="tab-layer tab-layer-2"><div class="fav-icon"></div></div>';d.html(h)}for(n=0;n<k.length;n++)if(i=k[n],i.highlighted){a(i,n,k);break}}}};window.resize.layout=c}(),function(){var a={centerModal:function(a){a.css({"margin-top":a.outerHeight()/2*-1,"margin-left":a.outerWidth()/2*-1})},drawTable:function(a,b,c,d,e){e.beginPath();for(var f=a/d,g=b/c,h=1;c>h;h++)e.moveTo(0,g*h),e.lineTo(b,g*h);for(var i=1;d>i;i++)e.moveTo(f*i,0),e.lineTo(f*i,a);e.closePath(),e.stroke()},drawScaledTable:function(a,b,c,d,e){e.beginPath();var f=.1*a*c;"horizontal"===d?(e.moveTo(f,0),e.lineTo(f,a)):(e.moveTo(0,f),e.lineTo(b,f)),e.closePath(),e.stroke()},clearCanvas:function(){var a=$("canvas")[0],b=a.getContext("2d");b.clearRect(0,0,b.canvas.width,b.canvas.height)},initSortable:function(){$(".sortable").sortable().on("sortupdate",function(){resize.layout.updateLayoutStore(),sendTracking("dnd-event","dnd-label")}),b=!0},resetSortable:function(){if(b){var a=$(".sortable");a.sortable("destroy"),a.sortable()}}},b=!1;window.resize.util=a}(),function(a){function b(a){for(var b,e,f,g,k,l=a.displays,m=null,n=null,o=null,p=null,q=0,r=l.length;r>q;q++)k=l[q].workArea,(null===m||m>k.left)&&(m=k.left),(null===n||n<k.left+k.width)&&(n=k.left+k.width),(null===o||o>k.top)&&(o=k.top),(null===p||p<k.top+k.height)&&(p=k.top+k.height);b=n-m,e=p-o,availableArea=c(),f=availableArea.width/b,g=availableArea.height/e,h=g>f?f:g,i=0!==m?-1*m*h:0,j=0!==o?-1*o*h:0,d(h,e)}function c(){a("#display-setting-layer");return{width:k,height:l}}function d(b,c){var d=a("#display-setting-layer");d.height(b*c)}function e(b,c,d){var e=a('<div class="display-entry" title="Please select display to use."><div class="display-meta"></div></div>');return e.css({top:b.top*h+j,left:b.left*h+i,width:b.width*h,height:b.height*h}).data(a.extend({id:c},b)),e.find(".display-meta").text(b.width+"x"+b.height),d&&e.addClass("selected"),e}var f,g=window.resize,h=.15,i=0,j=0,k=530,l=250,m={initialize:function(){chrome.system&&chrome.system.display&&(g.display=chrome.system.display,f=a("#display-setting-layer"),f.on("click",".display-entry",function(){var b=a(this),c={},d=b.data("id"),e=b.find(".display-meta").text();c[d]=!0,f.find(".display-entry").removeClass("selected"),b.addClass("selected"),sendTracking("display-select",e)}),g.display.getInfo(function(a){chrome.windows.getCurrent({populate:!0},function(c){var d,h,i={left:c.left+c.width-100,top:c.top+100},j=backJs.util.displayInfoFormatter(a,i);b(j);for(var k=0;k<j.displays.length;k++)h=j.displays[k],d=e(h.workArea,h.id,j.primaryIndex===k),f.append(d);chrome.tabs.query({currentWindow:!0,highlighted:!0},function(a){g.currentWindowTabs=a.length>1?a:c.tabs,g.layout.processTabInfo()})})}))}};g.displayUtil=m}(window.jQuery),function(){var a=window.resize,b=a.main_view,c=a.custom_view,d=a.util,e=a.layout,f=a.options,g=(a.displayUtil,$(document));g.ready(function(){b.initialize()}).on("click",".resize-selector-container",function(){var a=$(this).children(".resize-selector"),c=a.attr("data-selector-type"),d=-1!==c.indexOf("scale"),e=c.split("-"),f=d?e[0]:c.split("x"),g=d?e[2]:null;b[d?"resizeScaledTabs":"resizeTabs"](Number(f[0]),Number(f[1]),g),sendTracking("resize",c)}).on("show",".modal-box",function(a){a.stopPropagation(),d.centerModal($(this))}).on("click",".modal-box",function(a){a.stopPropagation()}).on("click",".close-button",function(a){a.stopPropagation();var b=$(this).siblings(".resize-selector").attr("data-selector-type");e.removeLayout(b),sendTracking("resize-delete",b)}).on("click","#undo-layout",function(){backJs.util.undoResize(a,f.disableUndoButton),sendTracking("undo","undo")}).on("click","#custom-layout",function(a){a.stopPropagation(),c.showCustomMenu(),sendTracking("custom-layout","open")}).on("click","#default-configuration",function(a){a.stopPropagation(),f.showConfirmationModal(),sendTracking("default-layout","open")}).on("click","#confirmation-cancel",function(){f.hideConfirmationModal(),sendTracking("default-layout","cancel")}).on("click","#confirmation-apply",function(){e.resetLayout(),f.hideConfirmationModal(),sendTracking("default-layout","apply")}).on("click","#input-cancel,.main-view",function(){$(".custom-view").hasClass("hidden")||(c.clearCustomValues(),c.hideCustomMenu(),sendTracking("custom-layout","cancel"))}).on("click","#input-save",function(){c.handleCustomSave(),sendTracking("custom-layout","apply")}).on("click","body",function(){$(".custom-view").hasClass("hidden")||(d.clearCanvas(),c.hideCustomMenu(),sendTracking("custom-layout","cancel-layer")),$(".confirmation-modal").hasClass("hidden")||(f.hideConfirmationModal(),sendTracking("default-layout","cancel-layer"))}).on("keyup","#numRows, #numCols",function(b){b.stopPropagation();var c=document.getElementById("myCanvas"),e=c.getContext("2d"),f=Number($("#numRows").attr("value")),g=Number($("#numCols").attr("value"));if(d.clearCanvas(),f&&f>0&&g&&g>0)f>a.canvasHeight/4&&(f=a.canvasHeight/4),g>a.canvasWidth/4&&(g=a.canvasWidth/4),d.drawTable(a.canvasWidth,a.canvasHeight,f,g,e),$("#input-save").removeClass("disabled");else{var h=$(this),i=Number(h.attr("value"));(0===i||isNaN(i))&&(h.attr("value",""),$("#input-save").addClass("disabled"))}}).on("change","#checkbox-single-tab",function(){var a=$(this).attr("checked");f.processSingleTabSelection(a),sendTracking("single-tab",a?"checked":"unchecked")}).on("change","#checkbox-empty-tab",function(){var a=$(this).attr("checked");f.processEmptyTabSelection(a),sendTracking("empty-tab",a?"checked":"unchecked")}).on("click","#display-setting",function(){var a,b=$(".main-view");b.toggleClass("display-selected"),a=b.hasClass("display-selected"),f.processDisplayLayerSelection(a),sendTracking("display-settings",a?"opened":"closed")}).on("click","#display-setting-layer .switch-toggle input",function(a,b){var c=$(this).attr("id");$("#display-setting-layer .switch-toggle").removeClass("right-align left-align").addClass(c+"-align"),f.processAlignmentSelection(c),b||sendTracking("alignment",c)}).on("click","#update-apply",function(){f.hideUpdateModal()}).on("click","#promo-apply",function(){f.hidePromoModal()}).on("click","#warning-apply",function(){f.hideWarningModal()}).on("click",".track-me a",function(){var a=$(this);a.hasClass("rate-it")?sendTracking("info-links","rate-it"):a.hasClass("options")?sendTracking("info-links","options"):a.hasClass("author")?sendTracking("info-links","author"):sendTracking("info-links","keyboard-shortcuts")}).on("click","a.keyboard-shortcuts",function(){chrome.tabs.create({url:"chrome://extensions/configureCommands"})}).on("click",".custom-view .switch-toggle.layout-option input",function(){var a=$(this).attr("id"),b=!1,e=$(".custom-view");("scaled"===a&&!e.hasClass("scaled")||"scaled"!==a&&e.hasClass("scaled"))&&(b=!0),e["scaled"===a?"addClass":"removeClass"]("scaled"),b&&(d.clearCanvas(),c.clearCustomValues(),"scaled"===a&&c.showScaledMenu(),sendTracking("custom-layout",a))}).on("click",".custom-view .scaled-input",function(){var a=$(this);$(".custom-view .scaled-input").removeClass("selected"),a.addClass("selected"),c.showScaledMenu(),sendTracking("custom-layout",a.text())}).on("click",".custom-view .switch-toggle.scaled-layout-orientation input",function(){c.showScaledMenu(),sendTracking("custom-layout",$(this).attr("id"))})}();