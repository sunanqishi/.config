var recorder=null;function getCamera(r,e){window.navigator.webkitGetUserMedia({video:{optional:[{echoCancellation:!1}]}},function(e){r(e)},function(e){})}chrome.runtime.onMessage.addListener(function(e,r,o){"stop"==e.name&&recorder.stream.stop()}),getCamera(function(e){var r={type:"video",disableLogs:!1,recorderType:MediaStreamRecorder};(recorder=RecordRTC(e,r)).stream=e,recorder.stream.onended=function(){recorder&&recorder.stream&&(recorder.stream.onended=function(){}),recorder.stopRecording(function(){new File([recorder.getBlob()],"AwesomeScreenshot-"+(new Date).toISOString().replace(/:|\./g,"-")+"camera.webm",{type:"video/webm"}),URL.createObjectURL(recorder.getBlob());fileSaver.save(recorder.getBlob(),"AwesomeScreenshot-"+(new Date).toISOString().replace(/:|\./g,"-")+".webm").then(function(e){localStorage.temp_camera_url=e,window.close()}).catch(function(e){})})},recorder.stream.getVideoTracks()[0].onended=function(){recorder&&recorder.stream&&recorder.stream.onended&&recorder.stream.onended()},recorder.startRecording(),document.getElementById("video").setAttribute("src",window.URL.createObjectURL(e))});